<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wheeledit CMS</title>
  </head>
  <body>
    <!-- Load Decap CMS -->
    <script src="https://unpkg.com/decap-cms@^3.4.0/dist/decap-cms.js"></script>

    <script>
      /*
       * ✅ Setup GitHub OAuth cho Decap CMS
       * Cấu hình GitHub OAuth App:
       *   Homepage URL: https://wheeledit-website.pages.dev/
       *   Authorization callback URL: https://decap-cms-oauth.vercel.app/callback
       */

      const CLIENT_ID = "Ov23lidowlEowxrO37wX"; // Client ID GitHub của bạn
      const OAUTH_PROXY = "https://decap-cms-oauth.vercel.app"; // Proxy server trung gian

      // Lấy mã code trả về từ GitHub (nếu có)
      const params = new URLSearchParams(window.location.search);
      const code = params.get("code");

      if (!code) {
        // Nếu chưa có code -> chuyển đến trang GitHub login
        const redirectUri = `${OAUTH_PROXY}/callback`;
        const authUrl = `https://github.com/login/oauth/authorize?client_id=${CLIENT_ID}&scope=repo,user&redirect_uri=${encodeURIComponent(redirectUri)}`;
        window.location.href = authUrl;
      } else {
        // Nếu có code (đã xác thực xong)
        window.location.href = `/admin/#/auth?code=${code}&provider=github`;
      }
    </script>
  </body>
</html>
